flowchart TD
    Start([🚀 Inicio]) --> Login[Login al Sistema]
    Login --> Dashboard[📊 Dashboard]
    
    Dashboard --> Decision1{Acción a realizar}
    
    %% Flujo de Solicitudes
    Decision1 -->|Crear Solicitud| SolCreate[📝 Cliente crea Solicitud]
    SolCreate --> SolPendiente[Estado: Pendiente]
    SolPendiente --> SolRevision{Coordinador revisa}
    SolRevision -->|Aprueba| SolAprobada[✅ Solicitud Aprobada]
    SolRevision -->|Rechaza| SolRechazada[❌ Solicitud Rechazada]
    SolRechazada --> NotifCliente1[📧 Notificar Cliente]
    NotifCliente1 --> End1([Fin])
    
    %% Flujo de OT
    SolAprobada --> OTCrear[📋 Coordinador genera OT]
    OTCrear --> OTAsignar[👤 Asignar Team Leader]
    OTAsignar --> NotifTL[📧 Notificar Team Leader]
    NotifTL --> OTProgreso[⚙️ Team Leader trabaja en OT]
    
    OTProgreso --> OTAvances[📝 Registrar Avances]
    OTAvances --> OTEvidencias[📸 Subir Evidencias]
    OTEvidencias --> OTCheck{¿100% completa?}
    OTCheck -->|No| OTProgreso
    OTCheck -->|Sí| OTCompletada[✅ OT Completada]
    
    %% Flujo de Calidad
    OTCompletada --> CalidadRevision[🔍 Calidad revisa]
    CalidadRevision --> CalidadDecision{Validación}
    CalidadDecision -->|Rechaza| OTRechazadaCalidad[❌ Rechazada]
    OTRechazadaCalidad --> NotifTL2[📧 Notificar Team Leader]
    NotifTL2 --> OTProgreso
    
    CalidadDecision -->|Aprueba| OTValidada[✅ Validada por Calidad]
    OTValidada --> NotifCliente2[📧 Notificar Cliente]
    
    %% Flujo de Autorización Cliente
    NotifCliente2 --> ClienteRevision[👤 Cliente revisa]
    ClienteRevision --> ClienteDecision{¿Autoriza?}
    ClienteDecision -->|No| Bloqueada[⏸️ OT Bloqueada]
    Bloqueada --> End2([Fin])
    
    ClienteDecision -->|Sí| ClienteAutoriza[✅ Cliente Autoriza]
    ClienteAutoriza --> NotifFacturacion[📧 Notificar Facturación]
    
    %% Flujo de Facturación (Solo procesos internos del sistema)
    NotifFacturacion --> FacturaCrear[💰 Crear Factura]
    FacturaCrear --> FacturaXML[� Subir XML para extraer datos]
    FacturaXML --> FacturaFacturado[✅ Marcar como Facturado]
    FacturaFacturado --> FacturaCobro[💵 Registrar Cobro]
    FacturaCobro --> FacturaPagado[✅ Marcar como Pagado]
    
    FacturaPagado --> End3([🎉 Proceso Completado])
    
    %% Otros flujos desde Dashboard
    Decision1 -->|Ver Órdenes| ListaOT[📋 Lista de OT]
    Decision1 -->|Ver Facturas| ListaFacturas[💰 Lista Facturas]
    Decision1 -->|Administrar| AdminPanel[⚙️ Panel Admin]
    Decision1 -->|Ver Notificaciones| Notificaciones[🔔 Notificaciones]
    
    ListaOT --> Dashboard
    ListaFacturas --> Dashboard
    AdminPanel --> Dashboard
    Notificaciones --> Dashboard
    
    style Start fill:#4caf50,stroke:#2e7d32,color:#fff
    style End1 fill:#f44336,stroke:#c62828,color:#fff
    style End2 fill:#ff9800,stroke:#e65100,color:#fff
    style End3 fill:#4caf50,stroke:#2e7d32,color:#fff
    style SolAprobada fill:#81c784,stroke:#388e3c
    style OTValidada fill:#81c784,stroke:#388e3c
    style ClienteAutoriza fill:#81c784,stroke:#388e3c
    style FacturaPagado fill:#81c784,stroke:#388e3c
    style SolRechazada fill:#e57373,stroke:#d32f2f
    style OTRechazadaCalidad fill:#e57373,stroke:#d32f2f
    style Bloqueada fill:#ffb74d,stroke:#f57c00
